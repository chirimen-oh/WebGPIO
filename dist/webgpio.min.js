"use strict";!function(){var e={IN:"in",OUT:"out"},r={ROW:0,HIGH:1},n=function(e){this.init(e)};n.prototype={init:function(e){var r=this;this.ports=new o;var n=function(e){return parseInt(e,10)},a=function(e){return r.ports.set(e,new t(e))};Object.keys(i.CHIRIMEN.PORTS).map(n).forEach(a)},ports:null,unexportAll:null,onchange:null};var t=function(e){this.init(e)};t.prototype={init:function(e){navigator.mozGpio["export"](e),this.portNumber=e,this.portName="",this.pinName="",this.direction="",this.exported=!1,this._interval=30,this.value=null,this._timer=null,this._DEVICES="CHIRIMEN"},"export":function(r){var n=this,t={"in":function(){return n._timer=setInterval(function(){return n.__checkValue(n)},n._interval)},out:function(){return n._timer?clearInterval(n._timer):0}},o=function(o,i){var a=t[r];a?(navigator.mozGpio.setDirection(n.portNumber,r===e.OUT),a(),o()):i(new Error("InvalidAccessError"))},a=function(e){return n.direction=r,n.exported=!0,n.pinName=i[n._DEVICES].PORTS[n.portNumber].pinName,n.portName=i[n._DEVICES].PORTS[n.portNumber].portName,e},p=function(e){return n.direction="",n.exported=!1,n.pinName="",n.portName="",Promise.reject(e)};return new Promise(o).then(a)["catch"](p)},unexport:function(e){},read:function(){var e=this,r=function(r,n){e.exported?e.__isInput()||n(new Error("OperationError")):n(new Error("InvalidAccessError")),r()},n=function(){return navigator.mozGpio.getValue(e.portNumber)};return new Promise(r).then(n)},write:function(e){var n=this,t=function(t,o){n.exported?n.__isOutput()?e!==r.ROW&&e!==r.HIGH&&o(new Error("OperationError")):o(new Error("OperationError")):o(new Error("InvalidAccessError")),t()},o=function(){return n.value=e,navigator.mozGpio.setValue(n.portNumber,n.value),n.value};return new Promise(t).then(o)},onchange:null,__isInput:function(){return this.direction===e.IN},__isOutput:function(){return this.direction===e.OUT},__checkValue:function(e){return e.read().then(function(r){parseInt(r)!=parseInt(e.value)&&("function"==typeof e.onchange?e.onchange(e):console.log("port.onchange is not a function."),e.value=r)})}};var o=Map;navigator.requestGPIOAccess||(navigator.requestGPIOAccess=function(){return new Promise(function(e){return e(new n)})});var i={CHIRIMEN:{PORTS:{256:{portName:"CN1.I2C2_SDA",pinName:"2"},257:{portName:"CN1.I2C2_SCL",pinName:"3"},283:{portName:"CN1.UART3_RX",pinName:"4"},284:{portName:"CN1.UART3_TX",pinName:"5"},196:{portName:"CN1.SPI0_CS",pinName:"7"},197:{portName:"CN1.SPI0_CLK",pinName:"8"},198:{portName:"CN1.SPI0_RX",pinName:"9"},199:{portName:"CN1.SPI0_TX",pinName:"10"},244:{portName:"CN1.SPI1_CS",pinName:"11"},243:{portName:"CN1.SPI1_CLK",pinName:"12"},246:{portName:"CN1.SPI1_RX",pinName:"13"},245:{portName:"CN1.SPI1_TX",pinName:"14"},163:{portName:"CN2.PWM0",pinName:"10"},253:{portName:"CN2.I2C0_SCL",pinName:"11"},252:{portName:"CN2.I2C0_SDA",pinName:"12"},193:{portName:"CN2.UART0_TX",pinName:"13"},192:{portName:"CN2.UART0_RX",pinName:"14"},353:{portName:"CN2.GPIO6_A1",pinName:"15"}},I2C_PORTS:{0:{SDA:{portName:"CN2.I2C0_SCL",pinName:"11"},SCL:{portName:"CN2.I2C0_SDA",pinName:"12"}},2:{SDA:{portName:"CN1.I2C2_SDA",pinName:"2"},SCL:{portName:"CN1.I2C2_SCL",pinName:"3"}}}}}}();