"use strict";!function(){var r={IN:"in",OUT:"out"},e={ROW:0,HIGH:1},n=function(r){this.init(r)};n.prototype={init:function(r){var e=this;this.ports=new o;var n=function(r){return parseInt(r,10)},a=function(r){return e.ports.set(r,new t(r))};Object.keys(i.CHIRIMEN.PORTS).map(n).forEach(a)},ports:null,unexportAll:null,onchange:null};var t=function(r){this.init(r)};t.prototype={init:function(r){navigator.mozGpio["export"](r),this.portNumber=r,this.portName="",this.pinName="",this.direction="",this.exported=!1,this._interval=30,this.value=null,this._timer=null,this._DEVICES="CHIRIMEN"},"export":function(e){var n=this,t={"in":function(){return n._timer=setInterval(function(){return n.__checkValue(n)},n._interval)},out:function(){return n._timer?clearInterval(n._timer):0}},o=function(o,i){var a=t[e];a?(navigator.mozGpio.setDirection(n.portNumber,e===r.OUT),a(),o()):i(new Error("InvalidAccessError"))},a=function(r){return n.direction=e,n.exported=!0,n.pinName=i[n._DEVICES].PORTS[n.portNumber].pinName,n.portName=i[n._DEVICES].PORTS[n.portNumber].portName,r},p=function(r){return n.direction="",n.exported=!1,n.pinName="",n.portName="",Promise.reject(r)};return new Promise(o).then(a)["catch"](p)},unexport:function(r){},read:function(){var r=this,e=function(e,n){r.exported?r.__isInput()||n(new Error("OperationError")):n(new Error("InvalidAccessError")),e()},n=function(){return navigator.mozGpio.getValue(r.portNumber)};return new Promise(e).then(n)},write:function(r){var n=this,t=function(t,o){n.exported?n.__isOutput()?r!==e.ROW&&r!==e.HIGH&&o(new Error("OperationError")):o(new Error("OperationError")):o(new Error("InvalidAccessError")),t()},o=function(){return n.value=r,navigator.mozGpio.setValue(n.portNumber,n.value),n.value};return new Promise(t).then(o)},onchange:null,__isInput:function(){return this.direction===r.IN},__isOutput:function(){return this.direction===r.OUT},__checkValue:function(r){return r.read().then(function(e){parseInt(e)!=parseInt(r.value)&&("function"==typeof r.onchange?r.onchange(r):console.log("port.onchange is not a function."),r.value=e)})}};var o=Map;navigator.requestGPIOAccess||(navigator.requestGPIOAccess=function(){return new Promise(function(r){return r(new n)})});var i={CHIRIMEN:{PORTS:{256:{portName:"CN1.I2C2_SDA",pinName:"2"},257:{portName:"CN1.I2C2_SCL",pinName:"3"},283:{portName:"CN1.UART3_RX",pinName:"4"},284:{portName:"CN1.UART3_TX",pinName:"5"},196:{portName:"CN1.SPI0_CS",pinName:"7"},197:{portName:"CN1.SPI0_CLK",pinName:"8"},198:{portName:"CN1.SPI0_RX",pinName:"9"},199:{portName:"CN1.SPI0_TX",pinName:"10"},244:{portName:"CN1.SPI1_CS",pinName:"11"},243:{portName:"CN1.SPI1_CLK",pinName:"12"},246:{portName:"CN1.SPI1_RX",pinName:"13"},245:{portName:"CN1.SPI1_TX",pinName:"14"},163:{portName:"CN2.PWM0",pinName:"10"},253:{portName:"CN2.I2C0_SCL",pinName:"11"},252:{portName:"CN2.I2C0_SDA",pinName:"12"},193:{portName:"CN2.UART0_TX",pinName:"13"},192:{portName:"CN2.UART0_RX",pinName:"14"},353:{portName:"CN2.GPIO6_A1",pinName:"15"}}}}}();